{
  "_metadata": {
    "pack": "entra-permissions-management",
    "version": "1.0.0",
    "description": "Sample right-size recommendation format. Actual recommendations generated by Permissions Management."
  },
  "recommendations": [
    {
      "identityName": "svc-devops-pipeline",
      "identityType": "ServicePrincipal",
      "currentRole": "Owner",
      "currentScope": "/subscriptions/{{PROD_SUB_ID}}",
      "currentPCI": 96,
      "usedActions": [
        "Microsoft.Storage/storageAccounts/blobServices/containers/blobs/write",
        "Microsoft.Web/sites/restart/action",
        "Microsoft.Web/sites/config/list/action",
        "Microsoft.Resources/deployments/write"
      ],
      "recommendedAction": "Replace with custom role containing only the 4 used actions",
      "recommendedScope": "/subscriptions/{{PROD_SUB_ID}}/resourceGroups/rg-webapp-prod",
      "projectedPCI": 12,
      "status": "Applied"
    },
    {
      "identityName": "svc-backup-agent",
      "identityType": "ServicePrincipal",
      "currentRole": "Contributor",
      "currentScope": "/subscriptions/{{PROD_SUB_ID}}",
      "currentPCI": 89,
      "usedActions": ["Microsoft.Storage/storageAccounts/blobServices/*"],
      "recommendedAction": "Assign Storage Blob Data Contributor at storage account scope",
      "recommendedScope": "/subscriptions/{{PROD_SUB_ID}}/resourceGroups/rg-backup/providers/Microsoft.Storage/storageAccounts/stbackupprod",
      "projectedPCI": 18,
      "status": "Applied"
    }
  ]
}
